#!/bin/bash
if [[ `uname` == "Darwin" ]]; then
  if [[ $(ps -ef | grep "Emacs --daemon" | grep -v grep) == "" ]]; then
    /Applications/Emacs.app/Contents/MacOS/Emacs --daemon
  fi
  if test -n "$DISPLAY"; then
    SWITCHES='-n -c'
    if [[ "$1" == "-t" ]]; then
      SWITCHES='-t'
    fi
    exec /Applications/Emacs.app/Contents/MacOS/bin/emacsclient $SWITCHES "$@"
  else
    /Applications/Emacs.app/Contents/MacOS/bin/emacsclient -t "$@" 
  fi
else
  /usr/bin/emacs "$@"
fi
